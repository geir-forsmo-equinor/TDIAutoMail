Screen1 As screen:
    Fill: =RGBA(0, 0, 0, 1)

    DataTable1 As dataTable.datatable:
        BorderStyle: =BorderStyle.Solid
        DisplayMode: =DisplayMode.Edit
        Fill: =RGBA(0, 0, 0, 0)
        Height: =120
        Items: ='TDI DO AutoMail Status List'
        Width: =1285
        X: =40
        Y: =40
        ZIndex: =1

        "'Run Name_Column1' As dataTableColumn.textualColumn":
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Run Name"
            FieldName: ="Title"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =1
            Text: =ThisItem.'Run Name'
            Width: =100
            X: =0
            Y: =0
            ZIndex: =1

        "'Run Type_Column1' As dataTableColumn.textualColumn":
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Run Type"
            FieldName: ="SecurityClassification"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =2
            Text: =ThisItem.'Run Type'.Value
            Width: =100
            X: =0
            Y: =0
            ZIndex: =2

        Status_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Status"
            FieldName: ="Status"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =3
            Text: =ThisItem.Status.Value
            Width: =100
            X: =0
            Y: =0
            ZIndex: =3

        Comments_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Comments"
            FieldName: ="Comments"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =4
            Text: =ThisItem.Comments
            Width: =100
            X: =0
            Y: =0
            ZIndex: =4

        Duration_Column1 As dataTableColumn.dateTimeColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Duration"
            FieldName: ="Duration"
            FieldVariantName: ="dateTimeColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =5
            Text: =Text(ThisItem.Duration,DateTimeFormat.LongDateTime)
            Width: =100
            X: =0
            Y: =0
            ZIndex: =5

        "'Sent Count_Column1' As dataTableColumn.numberColumn":
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Sent Count"
            FieldName: ="SentCount"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =6
            Text: =ThisItem.'Sent Count'
            Width: =100
            X: =0
            Y: =0
            ZIndex: =6

        "'Receiver Count_Column1' As dataTableColumn.numberColumn":
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Receiver Count"
            FieldName: ="ReceiverCount"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =7
            Text: =ThisItem.'Receiver Count'
            Width: =100
            X: =0
            Y: =0
            ZIndex: =7

    Button1 As button:
        OnSelect: |-
            =//create GUID
            Set(gbl_stateGUID,GUID());
            
            //start Power Automate Flow
            flowStatus.Run(gbl_stateGUID)
        Text: ="Submit"
        X: =421
        Y: =193
        ZIndex: =2

    Timer1 As timer:
        AutoStart: =!IsBlank(gbl_stateGUID)
        Duration: =500
        OnTimerEnd: |-
            =Refresh(LogList);
            UpdateContext({loc_currentStatus: LookUp(LogList,GUID=Text(gbl_stateGUID))})
        Repeat: =loc_currentStatus.Status<>3
        Visible: =false
        X: =1041
        Y: =193
        ZIndex: =3

    Gallery1 As gallery.galleryVertical:
        DelayItemLoading: =true
        DisplayMode: =DisplayMode.View
        Height: =315
        Items: |-
            =Table(
                {
                    Id: 1,
                    Value: "validated data",
                    Icon: Icon.Check
                },
                {
                    Id: 2,
                    Value: "approval pending",
                    Icon: Icon.Check
                },
                {
                    Id: 3,
                    Value: "approval granted",
                    Icon: Icon.Check
                }
            )
        Layout: =Layout.Vertical
        LoadingSpinner: =LoadingSpinner.Data
        TemplateSize: =92
        Width: =336
        X: =435
        Y: =295
        ZIndex: =4

        Label1 As label:
            Color: =RGBA(255, 255, 255, 1)
            Height: =23
            OnSelect: =Select(Parent)
            Text: =ThisItem.Value
            Width: =252
            X: =43
            Y: =3
            ZIndex: =1

        Circle2 As circle:
            BorderColor: =RGBA(39, 113, 194, 1)
            BorderThickness: =1
            Fill: =If(loc_currentStatus.Status>=ThisItem.Id, Self.BorderColor, Color.Transparent)
            Height: =28
            OnSelect: =Select(Parent)
            Width: =30
            ZIndex: =2

        Icon2 As icon.Check:
            Color: =RGBA(255, 255, 255, 1)
            Height: =23
            Icon: =Icon.Check
            OnSelect: =Select(Parent)
            Visible: =loc_currentStatus.Status>=ThisItem.Id
            Width: =25
            X: =3
            Y: =3
            ZIndex: =3

        Rectangle8 As rectangle:
            Height: =70
            OnSelect: =Select(Parent)
            Visible: =If(loc_currentStatus.Status>=ThisItem.Id, true, false)
            Width: =3
            X: =13
            Y: =26
            ZIndex: =4

    Button2 As button:
        OnSelect: |-
            =UpdateContext(
                {
                    loc_currentStatus: Patch(loc_currentStatus,
                        {
                            Status: 0,
                            Title: "you submitted"
                        }
                    )
                }
            );
             Set(gbl_stateGUID,"");
        Text: ="Reset"
        X: =620
        Y: =193
        ZIndex: =5

    Label3 As label:
        Color: =RGBA(255, 255, 255, 1)
        Text: |-
            ="Current State: " & loc_currentStatus.Title
        Width: =378
        X: =455
        Y: =670
        ZIndex: =6

